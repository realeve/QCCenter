var dashboardApp=function(){var t,a=!1,e=[],o=function(){var e=function(){function a(t,a,e){a.content.html(t),a.cubeportfolio.$obj.trigger("updateSinglePageInlineStart.cbp"),"function"==typeof e&&e(),a.singlePageInlineIsOpen.call(a)}$("#js-grid-lightbox-gallery").cubeportfolio({filters:"#js-filters-lightbox-gallery1",loadMore:"#js-loadMore-lightbox-gallery",loadMoreAction:"click",layoutMode:"grid",mediaQueries:[{width:1500,cols:7},{width:1100,cols:6},{width:800,cols:5},{width:480,cols:3},{width:320,cols:2}],defaultFilter:"*",animationType:"scaleDown",gapHorizontal:10,gapVertical:10,gridAdjustment:"responsive",caption:"",displayType:"default",lightboxDelegate:".cbp-lightbox",lightboxGallery:!0,lightboxTitleSrc:"data-title",lightboxCounter:'<div class="cbp-popup-lightbox-counter">{{current}} of {{total}}</div>',singlePageInlineDelegate:".cbp-singlePageInline",singlePageInlinePosition:"below",singlePageInlineInFocus:!0,singlePageInlineCallback:function(e,o){e=e.replace("#img","");var i,l=this;data={item:t.data[e],header:t.header},t.rows?(data.item[24]=data.item[24].replace(" ","T"),i=tpl.getHTML("dashboard/code/detail.etpl",data)):i="<h3>当前时间内无相关信息</h3></div>",a(i,l),n(e),r(e)}},function(){})};a?$("#js-grid-lightbox-gallery").cubeportfolio("destroy",e):e(),a=!0},i=function(){var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=316&M=3&blob=25;26;27&cache=0.25";a="./topic/testData/online/online.json",$.ajax({url:a}).done(function(a){t={rows:0};var e=$("#js-grid-lightbox-gallery");if(a.rows>0){a.data=_.sortBy(a.data,function(t){return t[11]});var i=tpl.getHTML("dashboard/code/imglist.etpl",a);e.html(i),o(),t=a}else e.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关信息</h3></div>')}).fail(function(t){console.log("read data error:<br>"),console.log(t.responseText)})},n=function(a){var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=283&M=0&cart="+t.data[a][0]+"&cache=1440";e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=283&M=0&cart=1620A285&cache=1440",$.ajax({url:e}).done(function(t){t=handleAjaxData(t),t.data.map(function(a,e){t.data[e].WeekDay=getWeekdayByDate(a.StartDate),t.data[e].DateTitle=a.StartDate.replace(" ","T")+"+08"});var a=$("#prodinfo");if(t.rows>0){var e=tpl.getHTML("dashboard/code/prodinfo.etpl",t);a.html(e),$("[name=isodate]").prettyDate({interval:1e4})}else a.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关生产信息</h3></div>')}).fail(function(t){console.log("read data error:<br>"),console.log(t),console.log(t.responseText)})},r=function(a){function o(t,a){var e=a.data[0][t];return e="AA=="==e?"../assets/global/img/none.png":"data:image/jpg;base64,"+e}var i=function(t){var a=getRootPath()+"/DataInterface/Api?Token="+config.TOKEN+"&blob=1&ID=254&cache=14400&M=3&t="+t;$.ajax({url:a}).done(function(a){a=$.parseJSON(a);var e=o(0,a);$('[name="hisImg'+t+'"]').attr("src",e)})};(function(){var o=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=317&M=3&cart="+t.data[a][0];o=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=317&M=3&cart=1620A285";var i={xAxis:[],yAxis:[]};$.ajax({url:o}).done(function(t){var a=handleAjaxData(t);a.rows>0&&a.data.reverse().map(function(t){var a=t[0].substr(4,2)+"/"+t[0].substr(6);i.xAxis.push(a),i.yAxis.push(t[1])}),i.type="line",e[1]=echarts.init(document.getElementById("nocheckDetail")),type=!0;var o={tooltip:{trigger:"axis",formatter:"{b}<br>{c}大张"},color:["#659be0"],xAxis:{type:"category",data:i.xAxis,axisTick:{show:!1},axisLine:{show:!1},show:type},grid:{x:type?50:30,y:10,x2:10,y2:20},yAxis:{type:"value",axisTick:{show:!1},axisLine:{show:!1},min:0},series:[{type:"line",smooth:!0,barMaxWidth:25,data:i.yAxis}]};e[1].setOption(o)})})(),function(){var o={xAxis:[],yAxis:[]},n=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=282&M=3&cart="+t.data[a][0];n=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=282&M=3&cart=1620A285",$.ajax({url:n}).done(function(t){var a=handleAjaxData(t);tpl.render("feedback/hislist.etpl",a,$("#hislist")),a.rows>0&&a.data.map(function(t){o.xAxis.push(t[1]),o.yAxis.push(t[2]),i(t[0])}),o.type="line",e[0]=echarts.init(document.getElementById("goodrateDetail"));var n=getSimpleEChart(o);e[0].setOption(n)})}()};return{init:function(){var t=["dashboard/code/imglist.etpl","dashboard/code/detail.etpl","dashboard/code/prodinfo.etpl","feedback/hislist.etpl"];tpl.init(t),i()},reload:function(){setInterval(function(){i()},3e4)}}}();$(document).ready(function(){toggleSidebar(),whiteBackground(),hideSidebarTool(),UIIdleTimeout.init(),initDom(0),dashboardApp.init()});