var dashboardApp=function(){var t,e=!1,a=[],i=function(){var a=function(){function e(t,e,a){e.content.html(t),e.cubeportfolio.$obj.trigger("updateSinglePageInlineStart.cbp"),"function"==typeof a&&a(),e.singlePageInlineIsOpen.call(e)}$("#js-grid-lightbox-gallery").cubeportfolio({filters:"#js-filters-lightbox-gallery1",loadMore:"#js-loadMore-lightbox-gallery",loadMoreAction:"click",layoutMode:"grid",mediaQueries:[{width:1500,cols:7},{width:1100,cols:6},{width:800,cols:5},{width:480,cols:3},{width:320,cols:2}],defaultFilter:"*",animationType:"scaleDown",gapHorizontal:10,gapVertical:10,gridAdjustment:"responsive",caption:"",displayType:"default",lightboxDelegate:".cbp-lightbox",lightboxGallery:!0,lightboxTitleSrc:"data-title",lightboxCounter:'<div class="cbp-popup-lightbox-counter">{{current}} of {{total}}</div>',singlePageInlineDelegate:".cbp-singlePageInline",singlePageInlinePosition:"below",singlePageInlineInFocus:!0,singlePageInlineCallback:function(a,i){a=a.replace("#img","");var o,l=this;data={item:t.data[a],header:t.header},t.rows?(data.item[24]=data.item[24].replace(" ","T"),o=tpl.getHTML("dashboard/code/detail.etpl",data)):o="<h3>当前时间内无相关信息</h3></div>",e(o,l),n(a),r(a)}},function(){})};e?$("#js-grid-lightbox-gallery").cubeportfolio("destroy",a):a(),e=!0},o=function(){var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=316&M=3&blob=25;26;27&cache=0.25";$.ajax({url:e}).done(function(e){e=$.parseJSON(e),t={rows:0};var a=$("#js-grid-lightbox-gallery");if(e.rows>0){e.data=_.sortBy(e.data,function(t){return t[11]});var o=tpl.getHTML("dashboard/code/imglist.etpl",e);a.html(o),i(),t=e}else a.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关信息</h3></div>')}).fail(function(t){console.log("read data error:<br>"),console.log(t.responseText)})},n=function(e){var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=283&M=0&cart="+t.data[e][0]+"&cache=1440";$.ajax({url:a}).done(function(t){t=handleAjaxData(t),t.data.map(function(e,a){t.data[a].WeekDay=getWeekdayByDate(e.StartDate),t.data[a].DateTitle=e.StartDate.replace(" ","T")+"+08"});var e=$("#prodinfo");if(t.rows>0){var a=tpl.getHTML("dashboard/code/prodinfo.etpl",t);e.html(a),$("[name=isodate]").prettyDate({interval:1e4})}else e.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关生产信息</h3></div>')}).fail(function(t){console.log("read data error:<br>"),console.log(t),console.log(t.responseText)})},r=function(e){function i(t,e){var a=e.data[0][t];return a="AA=="==a?"../assets/global/img/none.png":"data:image/jpg;base64,"+a}var o=function(t){var e=getRootPath()+"/DataInterface/Api?Token="+config.TOKEN+"&blob=1&ID=254&cache=14400&M=3&t="+t;$.ajax({url:e}).done(function(e){e=$.parseJSON(e);var a=i(0,e);$('[name="hisImg'+t+'"]').attr("src",a)})};(function(){var i=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=318&M=3&cart="+t.data[e][0],o={xAxis:[],yAxis:[]};$.ajax({url:i}).done(function(t){var e=handleAjaxData(t);e.rows>0&&e.data.reverse().map(function(t){var e=t[0].substr(4,2)+"/"+t[0].substr(6);o.xAxis.push(e),o.yAxis.push(t[1])}),o.type="line",a[1]=echarts.init(document.getElementById("nocheckDetail")),type=!0;var i={tooltip:{trigger:"axis",formatter:"{b}<br>{c}大张"},color:["#659be0"],xAxis:{type:"category",data:o.xAxis,axisTick:{show:!1},axisLine:{show:!1},show:type},grid:{x:type?50:30,y:10,x2:10,y2:20},yAxis:{type:"value",axisTick:{show:!1},axisLine:{show:!1},min:0},series:[{type:"line",smooth:!0,barMaxWidth:25,data:o.yAxis}]};a[1].setOption(i)})})(),function(){var i={xAxis:[],yAxis:[]},n=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=282&M=3&cart="+t.data[e][0];$.ajax({url:n}).done(function(t){var e=handleAjaxData(t);tpl.render("feedback/hislist.etpl",e,$("#hislist")),e.rows>0&&e.data.map(function(t){i.xAxis.push(t[1]),i.yAxis.push(t[2]),o(t[0])}),i.type="line",a[0]=echarts.init(document.getElementById("goodrateDetail"));var n=getSimpleEChart(i);a[0].setOption(n)})}()};return{init:function(){var t=["dashboard/code/imglist.etpl","dashboard/code/detail.etpl","dashboard/code/prodinfo.etpl","feedback/hislist.etpl"];tpl.init(t),o()},reload:function(){setInterval(function(){o()},3e4)}}}();$(document).ready(function(){toggleSidebar(),whiteBackground(),hideSidebarTool(),UIIdleTimeout.init(),initDom(0),dashboardApp.init()});