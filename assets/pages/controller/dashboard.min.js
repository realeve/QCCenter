var dashboardApp=function(){var e,t=!1,a=[],o=function(){var a=function(){function t(e,t,a){t.content.html(e),t.cubeportfolio.$obj.trigger("updateSinglePageInlineStart.cbp"),"function"==typeof a&&a(),t.singlePageInlineIsOpen.call(t)}$("#js-grid-lightbox-gallery").cubeportfolio({filters:"#js-filters-lightbox-gallery1",loadMore:"#js-loadMore-lightbox-gallery",loadMoreAction:"click",layoutMode:"grid",mediaQueries:[{width:1500,cols:7},{width:1100,cols:6},{width:800,cols:5},{width:480,cols:3},{width:320,cols:2}],defaultFilter:"*",animationType:"scaleDown",gapHorizontal:10,gapVertical:10,gridAdjustment:"responsive",caption:"",displayType:"default",lightboxDelegate:".cbp-lightbox",lightboxGallery:!0,lightboxTitleSrc:"data-title",lightboxCounter:'<div class="cbp-popup-lightbox-counter">{{current}} of {{total}}</div>',singlePageInlineDelegate:".cbp-singlePageInline",singlePageInlinePosition:"below",singlePageInlineInFocus:!0,singlePageInlineCallback:function(a,o){a=a.replace("#img","");var i,l=this;data={item:e.data[a],header:e.header},e.rows?(data.item[24]=data.item[24].replace(" ","T"),i=tpl.getHTML("dashboard/code/detail.etpl",data)):i="<h3>当前时间内无相关信息</h3></div>",t(i,l),n(a),r(a)}},function(){})};t?$("#js-grid-lightbox-gallery").cubeportfolio("destroy",a):a(),t=!0},i=function(){var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=316&M=3&blob=25;26;27&cache=0.25";$.ajax({url:t}).done(function(t){t=$.parseJSON(t),e={rows:0};var a=$("#js-grid-lightbox-gallery");if(t.rows>0){t.data=_.sortBy(t.data,function(e){return e[11]});var i=tpl.getHTML("dashboard/code/imglist.etpl",t);a.html(i),o(),e=t}else a.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关信息</h3></div>')}).fail(function(e){console.log("read data error:<br>"),console.log(e.responseText)})},n=function(t){var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=283&M=0&cart="+e.data[t][0]+"&cache=1440";$.ajax({url:a}).done(function(e){e=handleAjaxData(e),e.data.map(function(t,a){e.data[a].WeekDay=getWeekdayByDate(t.StartDate),e.data[a].DateTitle=t.StartDate.replace(" ","T")+"+08"});var t=$("#prodinfo");if(e.rows>0){var a=tpl.getHTML("dashboard/code/prodinfo.etpl",e);t.html(a),$("[name=isodate]").prettyDate({interval:1e4})}else t.addClass("cbp-ready").html('<div class="cbp-search-nothing"><h3>当前时间内无相关生产信息</h3></div>')}).fail(function(e){console.log("read data error:<br>"),console.log(e),console.log(e.responseText)})},r=function(t){function o(e,t){var a=t.data[0][e];return a="AA=="==a?"../assets/global/img/none.png":"data:image/jpg;base64,"+a}var i=function(e){var t=getRootPath()+"/DataInterface/Api?Token="+config.TOKEN+"&blob=1&ID=254&cache=14400&M=3&t="+e;$.ajax({url:t}).done(function(t){t=$.parseJSON(t);var a=o(0,t);$('[name="hisImg'+e+'"]').attr("src",a)})};(function(){var o=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=318&M=3&cart="+e.data[t][0],i={xAxis:[],yAxis:[]};$.ajax({url:o}).done(function(e){var t=handleAjaxData(e);t.rows>0&&t.data.reverse().map(function(e){var t=e[0].substr(4,2)+"/"+e[0].substr(6);i.xAxis.push(t),i.yAxis.push(e[1])}),i.type="line",a[1]=echarts.init(document.getElementById("nocheckDetail")),type=!0;var o={tooltip:{trigger:"axis",formatter:"{b}<br>{c}大张"},color:["#659be0"],xAxis:{type:"category",data:i.xAxis,axisTick:{show:!1},axisLine:{show:!1},show:type},grid:{x:type?50:30,y:10,x2:10,y2:20},yAxis:{type:"value",axisTick:{show:!1},axisLine:{show:!1},min:0},series:[{type:"line",smooth:!0,barMaxWidth:25,data:i.yAxis}]};a[1].setOption(o)})})(),function(){var o={xAxis:[],yAxis:[]},n=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=282&M=3&cart="+e.data[t][0];$.ajax({url:n}).done(function(e){var t=handleAjaxData(e);tpl.render("feedback/hislist.etpl",t,$("#hislist")),t.rows>0&&t.data.map(function(e){o.xAxis.push(e[1]),o.yAxis.push(e[2]),i(e[0])}),o.type="line",a[0]=echarts.init(document.getElementById("goodrateDetail"));var n=getSimpleEChart(o);a[0].setOption(n)})}()};return{init:function(){var e=["dashboard/code/imglist.etpl","dashboard/code/detail.etpl","dashboard/code/prodinfo.etpl","feedback/hislist.etpl"];tpl.init(e),i()},reload:function(){setInterval(function(){i()},3e4)}}}();$(document).ready(function(){toggleSidebar(),whiteBackground(),hideSidebarTool(),UIIdleTimeout.init(),initDom(0),dashboardApp.init(),dashboardApp.reload()});