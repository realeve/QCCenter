function GetJsonUrl(e){var t=getDateRange(),a=getRootPath()+"/DataInterface/Api?Token="+config.TOKEN+"&chartType=bar&ID="+e+"&M=3&tstart="+t.start+"&tend="+t.end+"&tstart2="+t.start+"&tend2="+t.end+"&t="+Math.random();return a}$("#HideTips").on("click",function(){$(".mt-element-ribbon").addClass("hide")});var convertData=function(e){function t(e,t){return e-t}function a(e){e.sort();for(var t=[e[0]],a=1;a<e.length;a++)e[a]!=t[t.length-1]&&t.push(e[a]);return t}function r(e){var r,i,n,s,o=[];if(r=ReadData(e.url),o.title=r.title,o.subTitle=r.source,o.rows=r.rows,0===r.rows)return o;if(3==r.cols){for(o.xAxisTitle=r.header[1].title,o.yAxisTitle=r.header[2].title,arrTemp=[],n=0;n<r.rows;n++)arrTemp[n]=r.data[n][0];for(arrTemp.sort(t),o.legend=a(arrTemp),arrTemp=[],n=0;n<r.rows;n++)arrTemp[n]=r.data[n][1];for(o.xAxis=a(arrTemp).sort(t),o.yAxis=[],n=0;n<o.legend.length;n++)o.yAxis[o.legend[n]]=[];for(n=0;n<o.legend.length;n++)for(s=0;s<o.xAxis.length;s++)o.yAxis[o.legend[n]][s]="-";for(n=0;n<r.rows;n++)for(i=r.data[n][0],s=0;s<o.xAxis.length;s++)if(r.data[n][1]==o.xAxis[s]){o.yAxis[i][s]=parseFloat(r.data[n][2]);break}for(o.series=[],n=0;n<o.legend.length;n++)o.series[n]={name:o.legend[n],type:e.type,smooth:e.smooth,barMaxWidth:100,data:o.yAxis[o.legend[n]],markPoint:MPtStyle,markLine:MLnStyle_avg,itemStyle:dataStyle_iT}}else if(2==r.cols){for(o.xAxisTitle=r.header[0].title,o.yAxisTitle=r.header[1].title,arrTemp=[],n=0;n<r.rows;n++)arrTemp[n]=r.data[n][0];for(o.xAxis=a(arrTemp),o.yAxis=[],n=0;n<o.xAxis.length;n++)o.yAxis[n]="-";for(n=0;n<r.rows;n++)o.yAxis[n]=parseFloat(r.data[n][1]);o.legend=[],o.legend[0]=o.yAxisTitle,o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:100,data:o.yAxis,markPoint:MPtStyle,markLine:MLnStyle_avg,itemStyle:dataStyle_iT}}else if(1==r.cols){for(o.xAxisTitle="数据编号",o.yAxisTitle=r.header[0].title,o.legend=[],o.legend[0]=o.yAxisTitle,arrTemp=[],n=0;n<r.rows;n++)arrTemp[n]=n+1;for(o.xAxis=arrTemp,o.yAxis=[],n=0;n<r.rows;n++)o.yAxis[n]=parseFloat(r.data[n][0]);o.series=[],o.series[0]={name:o.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:100,data:o.yAxis,markPoint:MPtStyle,markLine:MLnStyle_avg,itemStyle:dataStyle_iT}}return o}return r(e)},mECharts=function(){function e(){require(["echarts","echarts/chart/line","echarts/chart/bar","echarts/chart/scatter","echarts/chart/pie","echarts/chart/radar","echarts/chart/gauge","echarts/chart/treemap","echarts/chart/map","echarts/chart/tree","echarts/chart/wordCloud"],function(e){c=e;var r;"undefined"==typeof Cookies.get("eCharts_theme")?(r="real2",Cookies.set("eCharts_theme","real2")):r=Cookies.get("eCharts_theme"),require(["theme/"+r],function(e){d=e,t(),a(d)})})}function t(){var e=$(".portlet-body.form");for(i=0;i<u;i++){var t='<div id="eChart-main'+i+'" optionKey="Line" class="eCharts-main margin-top-5"></div>';e.append(t)}var a=$(".eCharts-main"),r=e.width();a.css("width",r),a.css("height",r/(1==a.length?2:3))}function a(e,t){if(u&&c){var a,i,n={},o={id:getUrlParam("tid").split(","),type:null===getUrlParam("type")?["line"]:getUrlParam("type").split(","),smooth:null===getUrlParam("smooth")?["1"]:getUrlParam("smooth").split(",")};for(a=0;u>a;a++)n={url:GetJsonUrl(o.id[a]),type:handleParam(o.type,a,"line"),smooth:"1"==handleParam(o.smooth,a,"1"),blind:null===getUrlParam("blind")?!1:"0"!=getUrlParam("blind"),toolbox:!n.blind||!a},i=r(n),i!==!1?(m[a]=c.init(document.getElementById("eChart-main"+a),e),m[a].setOption(i)):infoTips("第"+(a+1)+"张图表无数据，请重新选择查询时间",2);n.blind&&s()}}function r(e){var t=convertData(e);if(0===t.rows)return!1;var a={title:{text:t.title,subtext:t.subTitle,x:"center"},tooltip:{trigger:"axis"},legend:{data:t.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16},show:!(t.legend.length<=1)},toolbox:{show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},dataZoom:{show:!(t.rows<=12),realtime:!0,start:0,end:100},calculable:!0,xAxis:[{name:t.xAxisTitle,axisTick:{show:!1},type:"category",boundaryGap:!0,data:t.xAxis}],yAxis:[{name:t.yAxisTitle,type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:8}}],series:t.series};return a}function n(){if($(".actions select opotion").length)return!1;var e,t=$(".actions select"),a="",r=["default","real2","real","macarons","helianthus","infographic","shine","dark","blue","green","red","gray","roma","macarons2","sakura"];r.map(function(e,t){a+='<option name="'+e+'">'+e+"</option>"}),t.html(a),"undefined"==typeof Cookies.get("eCharts_theme")?(e="real2",Cookies.set("eCharts_theme","real2")):e=Cookies.get("eCharts_theme"),t.find('[name="'+e+'"]').attr("selected",!0),$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),$("select.bs-select").hide()}function s(){for(var e,t=[],a=0;u>a;a++)if(e=u-1,t=[],"undefined"!=typeof $("#eChart-main"+e).attr("_echarts_instance_")){for(var r=0;u>r;r++)r!==a&&t.push(m[r]);u>1&&m[a].connect(t)}}function o(e){var t=e;"undefined"!=typeof Cookies&&Cookies.set("eCharts_theme",e),m[0].showLoading(),require(["theme/"+t],function(e){d=e,setTimeout(l(),500)})}function l(){for(i=0;i<u;i++)m[i].hideLoading(),m[i].setTheme(d)}function h(){var e=$(".actions select");e&&$(e).change(function(){o($(this).val())})}var c,d,m=[],u=null===getUrlParam("tid")?0:getUrlParam("tid").split(",").length;return require.config({paths:{echarts:"assets/global/plugins/echarts/js",theme:"assets/global/plugins/echarts/theme"}}),$(document).on("click",".ranges li:not(:last),button.applyBtn",function(){var e;e=$(".actions select"),require(["theme/"+e.val()],function(e){d=e,setTimeout(a(d),500)})}),$("#Preview a").on("click",function(){var e=$("#Preview input").val(),t=$(".actions select");require(["theme/"+t.val()],function(t){d=t,setTimeout(a(d,e+"&chartType=line"),500)})}),{init:function(){n(),e(),h()}}}();jQuery(document).ready(function(){UIIdleTimeout.init(),initDashboardDaterange("YYYYMMDD"),initDom(),mECharts.init(),1==App.getURLParameter("debug")||null===App.getURLParameter("tid")?$("#Preview").show():$("#Preview").hide(),hideSidebarTool()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=QualityChart_echart2.min.js.map