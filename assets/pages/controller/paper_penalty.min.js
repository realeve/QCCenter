var FakePiece=function(){function e(e){var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=251&M=3&t="+e;$.ajax({url:a}).done(function(e){e=handleAjaxData(e),InitSelect("oper_id",e),setTimeout(function(){SetSelect2Val("oper_id",-1)},0)})}function a(){$("input[name='rec_date']").val(today(6)),$("input[name='remark']").val("无"),$("input[name='more']").val("0"),$("input[name='less']").val("0");var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=24&M=3&t=1";$.ajax({url:a}).done(function(e){e=handleAjaxData(e),InitSelect("prod_id",e),initSelect2()}),$(".page-header .dropdown-quick-sidebar-toggler").hide(),iCheckBoxInit(),SetiCheckChecked("user_type",1),m(),e(2),$('[name="user_type"]').on("ifChecked",function(){l=GetiCheckChecked("user_type")+1,e(l),1===l?($('[name="large_fake_money"]').parent().find(".help-block").text("( 考核标准:100元/张 )"),$('[name="mid_fake_money"]').parent().find(".help-block").text("( 考核标准:10元/张 )"),$('[name="large_fake_money"]').val(100*$('[name="large_fake"]').val()),$('[name="mid_fake_money"]').val(10*$('[name="mid_fake"]').val())):($('[name="large_fake_money"]').parent().find(".help-block").text("( 考核标准:50元/张 )"),$('[name="mid_fake_money"]').parent().find(".help-block").text("( 考核标准:5元/张 )"),$('[name="large_fake_money"]').val(50*$('[name="large_fake"]').val()),$('[name="mid_fake_money"]').val(5*$('[name="mid_fake"]').val()))})}function t(){$(".detail input").val(""),$("[name='remark']").val("无"),$("[name='more']").val("0"),$("[name='less']").val("0"),SetSelect2Val("oper_id",-1)}function n(){var e=getRootPath()+"/DataInterface/insert",a=getFormData("theForm");a.utf2gbk=["remark"],a.tbl=TBL.PPR_PENALTY;var n={url:e,type:"post",resetForm:!0,data:a,success:function(e){var a=$.parseJSON(e);bsTips(a.message,a.type),t(),r()},error:function(e){infoTips(JSON.stringify(e))}};return a.serious_fake+a.large_fake>0?$.ajax(n):(bsTips("数据无效，严重废数量和一般废数量不能同时为0，请检查后重新输入！"),$('[name="serious_fake"]').focus()),!1}function r(){function e(e,a){var t="<tr>\t<td>"+a+"</td>";return e.map(function(e){t+="\t<td>"+e+"</td>"}),t+="</tr>"}var a=$('[name="fakeList"] tbody'),t=$("input[name='rec_date']").val();t=t.replace(/-/g,"");var n=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=252&M=3&tstart="+t,r=ReadData(n);if(0===r.rows)return void a.html('<tr><td class="text-center" colspan='+(r.cols+1)+">指定时间内无数据</td></tr>");var i="";r.data.map(function(a,t){i+=e(a,t+1)}),a.html(i)}function i(){var e=$("input[name='rec_date']").val();e=e.replace(/-/g,"");var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=253&M=3&tstart="+e;return a}function o(){var e={url:i(),type:"bar",background:"img"};require(["../assets/pages/controller/singleChart.min"],function(a){a.init(e,$('[name="singleChart"]'))})}var l,c=function(){jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd"})},m=function(){$("input[name='reel_code']").maxlength({limitReachedClass:"label label-danger",threshold:3}),extendValidateRule();var e=getValidateRule("theForm");e.rec_date.number=!1,e.serious_fake={digits:!0,required:!1,min:0},e.large_fake=e.serious_fake,e.more={required:!1,number:!0},e.less={required:!1,number:!0},$("form[name=theForm]").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!0,rules:e,messages:{reel_code:{required:"轴号不能为空."}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()},submitHandler:function(e){n()}})};return $('[name="serious_fake"]').on("keyup",function(){l=GetiCheckChecked("user_type")+1,$('[name="serious_fake_money"]').val(500*$(this).val())}),$('[name="large_fake"]').on("keyup",function(){l=GetiCheckChecked("user_type")+1;var e=1==l?100:50;$('[name="large_fake_money"]').val(e*$(this).val())}),$('[name="mid_fake"]').on("keyup",function(){l=GetiCheckChecked("user_type")+1;var e=1==l?10:5;$('[name="mid_fake_money"]').val(e*$(this).val())}),$('[name="reset"]').on("click",function(){t()}),{init:function(){c(),a(),r(),o()}}}();jQuery(document).ready(function(){initDom(),FakePiece.init()}),jQuery(window).resize(function(){HeadFix()});