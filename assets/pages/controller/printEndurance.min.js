var store,FakePiece=function(){function e(){var e=store.state.basic.rec_date.replace(/-/g,"");e=e.replace(/-/g,"");var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=328&M=3&tstart="+e+"&tend="+e;$.ajax({url:t}).done(function(e){var t=handleAjaxData(e);store.state.tbl=t})}function t(){var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=35&M=3&t=1&cache=14400";$.ajax({url:e}).done(function(e){var t=handleAjaxData(e);t.data.forEach(function(e){store.state.prodList.push({value:e[0],name:e[1]})}),initSelect2(),$(".select2").on("select2:select",function(){a($(this).val())})})}function a(e){switch(store.state.basic.prod_id=e,store.state.params.forEach(function(e,t){store.state.params[t].data="0"}),e){case"2":store.state.params[1].show=!1,store.state.params[2].show=!1,store.state.params[4].show=!1;break;case"3":case"4":case"6":case"7":store.state.params[1].show=!0,store.state.params[2].show=!1,store.state.params[4].show=!0;break;case"8":store.state.params[2].show=!0}}function r(){store=new Vuex.Store({state:{params:[{name:"耐干皱折(正面)",data:"0",key:"anti_CreaseF",show:!0},{name:"耐干皱折(反面)",data:"0",key:"anti_CreaseB",show:!0},{name:"耐干皱折(OVMI)",data:"0",key:"anti_CreaseOVMI",show:!0},{name:"机洗(正)",data:"0",key:"washF",show:!0},{name:"机洗(背)",data:"0",key:"washB",show:!0}],basic:{remark:"无",prod_id:"0",rec_date:today(6),gznumber:""},prodList:[{value:0,name:""}],tbl:{rows:0}},mutations:{submit:function(){var e=store.state,t={};for(var a in e.basic)t[a]=e.basic[a];e.params.forEach(function(e){t[e.key]=e.data}),s(t)},reset:function(){var e=store.state.params;e.forEach(function(t,a){e[a].data="0"})},loadHisData:function(){e()}}});new Vue({el:"#basic",store:!0,computed:{basic:function(){return store.state.basic},prodList:function(){return store.state.prodList}},mounted:function(){t()}}),new Vue({el:"#report",store:!0,data:{portletName:"耐性检测结果"},computed:{params:function(){return store.state.params}},methods:{submit:function(){store.commit("submit")},reset:function(){store.commit("reset")},loadHisData:function(){store.commit("loadHisData")}},mounted:function(){n()}}),new Vue({el:"#sheet",store:!0,computed:{tbl:function(){return store.state.tbl}}})}function s(t){var a=getRootPath()+"/DataInterface/insert";t.tbl=TBL.PRINT_ENDURANCE,t.utf2gbk=["remark"],t.rec_time=today(1);var r={url:a,type:"post",resetForm:!0,data:t,success:function(t){var a=$.parseJSON(t);bsTips(a.message,a.type),store.commit("reset"),e()},error:function(e){infoTips(JSON.stringify(e))}};return $.ajax(r),!1}var o=function(){jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd"})},n=function(){jQuery.validator.addMethod("gznumber",function(e,t){var a=/^[A-Za-z]{2}$|^[A-Za-z]\*[A-Za-z]$|^[A-Za-z]\*\*[A-Za-z]$/;return this.optional(t)||a.test(e)},"请检查冠字信息是否正确"),$("#gznumber").maxlength({limitReachedClass:"label label-danger",threshold:4});var e={gznumber:{gznumber:!0,required:!0},anti_CreaseF:{number:!0},anti_CreaseB:{number:!0},anti_CreaseOVMI:{number:!0},washF:{number:!0},washB:{number:!0}};$("form[name=theForm]").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!0,rules:e,messages:{gznumber:{required:"冠字信息不能为空."}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},success:function(e){e.closest(".form-group").removeClass("has-error"),e.remove()}})};return{init:function(){o(),$(".page-header .dropdown-quick-sidebar-toggler").hide(),r()}}}();jQuery(document).ready(function(){FakePiece.init(),initDom()}),jQuery(window).resize(function(){HeadFix()});